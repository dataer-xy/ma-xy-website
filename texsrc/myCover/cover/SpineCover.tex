\documentclass{ctexbook}% scrartcl
\input{../BookParameters.tex}

\usepackage{geometry}
\usepackage{graphicx}
\usepackage{pagecolor}
\usepackage{rotating} % 用于旋转对象
% %% 示例：
% \begin{sideways}将要打印的内容旋转90度\end{sideways}
% \begin{turn}{45}将要打印的内容旋转自定义角度\end{turn}
% \begin{rotate}{120}将要打印的内容旋转自定义角度，但是旋转结果并不能保证被旋转对象所需要的空间\end{rotate}

%% The spine is prepared sideways and rotated upon assembly.
\geometry{
  paperwidth=\CoverHeight in,%
  paperheight=\SpineWidth in,%
  left=\VerBleed  in + 3mm,% Provide a little extra room at top and bottom
  right=\VerBleed in + 3mm,%
  top=\FoldVariance in,%
  bottom=\FoldVariance in,%
  footskip=0.0 in%
}

\pagestyle{empty}

%% ---------------------------------------------------------------------------
%% ---------------------------------------------------------------------------
%%  The layout of the spine MUST be adjusted as the number of pages in
%%  the finished book changes. The placement of text is very important.
%% ---------------------------------------------------------------------------
%% ---------------------------------------------------------------------------
\begin{document}
\pagecolor{yellow!10}
\setlength\parindent{0ex}

% At 215 pages, the spine is wide enough to hold a publishers logo
% and a nice sized title. At 315 pages the spine can hold a subtitle.
% The logo is not available below 215 pages, and below 150 pages the
% title size is very reduced. A blank spine is used when the book has
% fewer than 123 pages.
\ifthenelse{\TotalPageCount < 215}{%
  \ifthenelse{\TotalPageCount < 150}{%
    \begin{minipage}{0.2\linewidth}
   	  \begin{center}
 	    \vspace*{-1.0mm}\textbf{ 宋焱燚等编著}%\textsf\TheAuthor
      \end{center}
    \end{minipage}
    \begin{minipage}{0.58\linewidth}
	  \begin{center}
 	    \vspace*{-1.0mm}{\textsf \TheMainTitle}\par
	  \end{center}
    \end{minipage}
    \begin{minipage}{0.23\linewidth}
	  \begin{center}
	    \vspace*{-1.0mm}\ThePublisherName
	  \end{center}
    \end{minipage}
  }{%
    \begin{minipage}[c][\textheight]{0.2\linewidth}
   	  \begin{center}
 	    {\Large{\textbf{宋焱燚等编著}}}% \textsf\TheAuthor
   	  \end{center}
    \end{minipage}
    \begin{minipage}[c][\textheight]{0.58\linewidth}
	  \begin{center}
        \Huge{\textsf \TheMainTitle}
	  \end{center}
    \end{minipage}
    \begin{minipage}[c][\textheight]{0.23\linewidth}
	  \begin{center}
 	    \Large{\ThePublisherName}
	  \end{center}
    \end{minipage}
  }%
}{%
  \begin{minipage}[c][\textheight]{0.5\linewidth} % 这里的0.5是minipage的大小
  \begin{center}
      \ifthenelse{\TotalPageCount < 315}{%
        { \begin{turn}{90}
        \Huge 模
        \end{turn}
        \begin{turn}{90}
        \Huge 型
        \end{turn}
        \begin{turn}{90}
        \Huge 与
        \end{turn}
        \begin{turn}{90}
        \Huge 算
        \end{turn}
        \begin{turn}{90}
        \Huge 法
        \end{turn}
        } \par% \Huge{\textsf\TheMainTitle}
      }{%
        { \begin{turn}{90}
        \Huge 模
        \end{turn}
        \begin{turn}{90}
        \Huge 型
        \end{turn}
        \begin{turn}{90}
        \Huge 与
        \end{turn}
        \begin{turn}{90}
        \Huge 算
        \end{turn}
        \begin{turn}{90}
        \Huge 法
        \end{turn}
        }% \Huge{\textsf\TheMainTitle}
        % \par
      % \vspace*{1.5mm}
      % {\Large{\textsf\TheSubTitle}}
      }
  \end{center}
  \end{minipage}
  \begin{minipage}[c][\textheight]{0.15\linewidth}
      \begin{center}
          \begin{turn}{90}
          {\Large{\textbf{\kaishu 宋}}}% \textsf\TheAuthor
          \end{turn}
          \begin{turn}{90}
          {\Large{\textbf{\kaishu 焱}}}% \textsf\TheAuthor
          \end{turn}
          \begin{turn}{90}
          {\Large{\textbf{\kaishu 燚}}}% \textsf\TheAuthor
          \end{turn}
          \begin{turn}{90}
          {\Large{\textbf{\kaishu 等}}}% \textsf\TheAuthor
          \end{turn}
          \begin{turn}{90}
          {\Large{\textbf{\kaishu 编}}}% \textsf\TheAuthor
          \end{turn}
          \begin{turn}{90}
          {\Large{\textbf{\kaishu 著}}}% \textsf\TheAuthor
          \end{turn}
      \end{center}
  \end{minipage}
  \begin{minipage}[c][\textheight]{0.13\linewidth}
      \begin{center}
      % \begin{turn}{270}
        {\Large{\ThePublisherName}}
      % \end{turn}
      w\end{center}
  \end{minipage}
   \begin{minipage}[c][\textheight]{0.1\linewidth}
     \includegraphics[width=10mm,angle=90,origin=c]{../images/PressLogo.png}%
  \end{minipage}
}%
\end{document}

